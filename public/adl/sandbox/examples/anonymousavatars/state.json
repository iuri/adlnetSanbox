[{"children":{"N43a11d4d":{"extends":"asset.vwf","properties":{"DisplayName":"Chemical Tanker","___assetServerOriginalID":"N65b7e28d","___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_angular":[0,0,0],"___physics_velocity_linear":[0,0,0],"___sourceAssetTimestamp":"Wed Nov 04 2015 14:11:23 GMT-0500 (Eastern Standard Time)","materialDef":{"alpha":1,"ambient":{"b":0.616883116883117,"g":0.616883116883117,"r":0.616883116883117},"blendMode":1,"color":{"a":1,"b":0.616883116883117,"g":0.616883116883117,"r":0.616883116883117},"combine":0,"depthtest":true,"depthwrite":true,"emit":{"b":0,"g":0,"r":0},"fog":true,"layers":[{"alpha":1,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"scalex":1,"scaley":1,"src":"/sas/assets/51c1a77e"}],"metal":false,"reflect":0.01,"shading":true,"shininess":0.000002,"side":0,"specularColor":{"a":1,"b":0,"g":0,"r":0},"specularLevel":1,"type":"phong","vertexColors":false,"wireframe":false},"owner":"ADLteam","sourceAssetId":"95bc52f8","transform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},"random":{"c":1,"s0":0.770068238954991,"s1":0.372494086623192,"s2":0.669335008133203},"sequence":0,"source":"/sas/assets/b7747e55","type":"subDriver/threejs/asset/vnd.gltf+json","name":"N43a11d4d"}},"extends":"box2.vwf","methods":{"activateState":{"body":"\n    var currentState = this.states[this.activeState];\n    if (currentState.transitions && currentState.transitions.indexOf(newState))\n    {\n        this.activeState = newState;\n        newState = this.states[newState];\n        if (!newState)\n        {\n            console.log('state does not exist');\n        }\n        if (newState.transitionFunc && this[newState.transitionFunc])\n        {\n            this[newState.transitionFunc]();\n        }\n\n    }\n    else\n    {\n        console.log('invalid transition');\n    }    \n","parameters":["newState"]},"buoyancy":{"body":"\n        var waterDepth = 20;\n    var hullThick = 2;\n    var depthFloor = waterDepth + hullThick;\n    // The tick function is called 20 times every second.\n    // Write code here to animate over time\n    this.physicsAPI.addForceAtCenter(0, 0, 9.8);\n    this.physicsAPI.wake();\n    var mass = this.physicsAPI.getMass();\n    var corners = [\n        [this._length / 2, this.width / 2, 0],\n        [this._length / 2, -this.width / 2, 0],\n        [-this._length / 2, this.width / 2, 0],\n        [-this._length / 2, -this.width / 2, 0],\n    ];\n\n    this.counter++;\n    var rocking = -mass / 2;\n    this.physicsAPI.addForceOffset([0, 0, rocking], [Math.sin(this.counter / 30) * this._length, Math.cos(this.counter / 15) * this.width, 0]);\n    this.physicsAPI.addForceOffset([0, 0, rocking], [Math.cos(this.counter / 10) * this._length, Math.sin(this.counter / 10) * this.width, 0]);\n\n    for (var i = 0; i < corners.length; i++)\n    {\n        var corner = corners[i];\n        var worldCorner = this.transformAPI.localToGlobal(corner);\n        var depth = depthFloor - worldCorner[2];\n        depth = Math.min(depth, 5);\n        if (depth > 0)\n        {\n\n            this.physicsAPI.addForceOffset([0, 0, depth * mass * 9.8 / 3], Vec3.subtract(worldCorner, this.transformAPI.getPosition(), []));\n            var vel = this.physicsAPI.getLinearVelocity();\n            var torque = this.physicsAPI.getAngularVelocity();\n            //    vel[0] *= .6;\n            // vel[1] *= .6;\n            vel[2] *= 1 - depth / 50;\n\n            torque[0] *= 1 - depth / 100;\n            torque[1] *= 1 - depth / 100;\n            torque[2] *= 1 - depth / 100;\n            this.physicsAPI.setAngularVelocity(torque);\n            this.physicsAPI.setLinearVelocity(vel);\n        }\n        //  if (depth < 0)\n        {\n\n            this.physicsAPI.addForceOffset([0, 0, -mass * 9.8 / 4], Vec3.subtract(worldCorner, this.transformAPI.getPosition(), []));\n            var vel = this.physicsAPI.getLinearVelocity();\n            var torque = this.physicsAPI.getAngularVelocity();\n        }\n\n    }\n\n    var depth = depthFloor - this.transformAPI.getPosition()[2]\n    depth = Math.min(depth, 5);\n    if (depth > 0)\n    {\n        //this.physicsAPI.addForceAtCenter(this.transformAPI.localToGlobal(0, 100, 0));\n        var vel = this.physicsAPI.getLinearVelocity();\n        vel = this.transformAPI.globalToLocalRotation(vel);\n        vel[0] *= 1.0 - depth / 10;\n        vel[1] *= 1.0 - depth / 3;\n        vel = this.transformAPI.localToGlobalRotation(vel);\n        this.physicsAPI.setLinearVelocity(vel);\n\n    }        \n","parameters":[]},"command":{"body":"\n    var command = args[0];\n    if (command == \"aheadFull\")\n    {\n        this.activateState('navigating');\n        this.engine = \"aheadFull\";\n    }\n    if (command == \"backFull\")\n    {\n        this.activateState('navigating');\n        this.engine = \"backFull\";\n    }\n    if (command == \"aheadHalf\")\n    {\n        this.activateState('navigating');\n        this.engine = \"aheadHalf\";\n    }\n    if (command == \"engineIdle\")\n    {\n        this.activateState('navigating');\n        this.engine = \"idle\";\n    }\n    if (command == \"hardRight\")\n    {\n        this.activateState('navigating');\n        this.rudder = \"hardRight\";\n    }\n    if (command == \"hardLeft\")\n    {\n        this.activateState('navigating');\n        this.rudder = \"hardLeft\";\n    }\n    if (command == \"rudderCenter\")\n    {\n        this.activateState('navigating');\n        this.rudder = \"center\";\n    }    \n","parameters":["args"]},"hit":{"body":"if (force > 5) //cannot be hurt by 50 cal\n    {\n\n    this.children_by_name.Barry1.materialDef.layers[0].src = this.damageTexture;\n    var sender = this.Scene.children_by_name.xAPISender;\n    if (sender)\n    {\n        sender.xAPISend(\"is-damaged\", this.DisplayName, \"TacticalActionOfficer\", null);\n    }\n    }","parameters":["pos","force"]},"movement":{"body":"var torque = [0, 0, 0];\n    var force = [0, 0, 0];\n    if (this.rudder == 'hardLeft')\n    {\n        torque[2] = .0001 * this.physicsAPI.getMass();\n    }\n    if (this.rudder == 'hardRight')\n    {\n        torque[2] = -.0001 * this.physicsAPI.getMass();\n    }\n    if (this.rudder == 'center')\n    {\n\n    }\n    if (this.engine == \"aheadFull\")\n    {\n        force[0] = 25 * this.physicsAPI.getMass();\n    }\n    if (this.engine == \"aheadHalf\")\n    {\n        force[0] = 12 * this.physicsAPI.getMass();\n    }\n    if (this.engine == \"idle\")\n    {\n\n    }\n    if (this.engine == 'backFull')\n    {\n        force[0] = -12 * this.physicsAPI.getMass();\n    }\n    torque[2] *= force[0];\n    force = this.transformAPI.localToGlobalRotation(force);\n    this.physicsAPI.addForceAtCenter(force);\n    this.physicsAPI.addTorque(torque);","parameters":[]},"tick":{"body":"\n    var state = this.states[this.activeState];\n    if (state)\n    {\n\n        if (state.movement)\n            this.movement();\n        if (state.buoyancy)\n            this.buoyancy();\n        if(state.updateFunc && this[state.updateFunc])\n            this[state.updateFunc]()\n        \n        \n    }    \n","parameters":[]}},"properties":{"DisplayName":"Chemical Tanker","EditorData":{"engine":{"displayname":"engine","labels":["Ahead Full","Ahead Half","Back","Idle"],"property":"engine","type":"choice","values":["aheadFull","aheadHalf","back","idle"]},"hullThick":{"displayname":"Hull Thickness","max":25,"min":0,"property":"hullThick","type":"slider"},"rudder":{"displayname":"rudder","labels":["Hard Right","Hard Left","center"],"property":"rudder","type":"choice","values":["hardRight","hardLeft","back"]},"state":{"displayname":"state","labels":["idle","navigating"],"property":"activeState","type":"choice","values":["idle","navigating"]}},"___physics_activation_state":4,"___physics_angular_velocity":[-0.0122641741070722,0.000383031924026727,0.0000144149799074967],"___physics_damping":0.4,"___physics_deactivation_time":0,"___physics_enabled":true,"___physics_linear_velocity":[3.49304580688477,-0.0114786426226298,0.00000867158467881381],"___physics_mass":80051.2,"___physics_velocity_angular":[-2.79396772384644e-9,4.65661287307739e-10,-0.0000449214203399606],"___physics_velocity_linear":[0.911871492862701,-0.0144484806805849,-0.000003814697265625],"___sourceAssetTimestamp":"Fri Mar 11 2016 16:14:26 GMT-0500 (Eastern Standard Time)","_length":230,"activeState":"navigating","counter":34191,"damageTexture":"/sas/assets/dde67e10","ditorData":"","engine":"aheadFull","height":10,"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"blendMode":0,"color":{"a":1,"b":1,"g":1,"r":1},"depthtest":true,"depthwrite":true,"emit":{"b":0,"g":0,"r":0},"fog":true,"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"metal":false,"reflect":0.8,"shadeless":false,"shading":true,"shadow":true,"shininess":15,"side":0,"specularColor":{"a":1,"b":0.57735,"g":0.57735,"r":0.57735},"specularLevel":1,"type":"phong","vertexColors":true,"wireframe":false},"owner":"admin","physicsAPI":{},"radarTracked":true,"rudder":"back","states":{"idle":{"buoyancy":true,"movement":false,"transitionFunc":null,"transitions":["navigating"],"updateFunc":null},"navigating":{"buoyancy":true,"movement":true,"transitionFunc":null,"transitions":["idle"],"updateFunc":null}},"transform":[1,-0.00000224607106247277,-2.32829068524953e-11,0,0.00000224607106247277,1,-1.39698419499013e-10,0,2.3283219102721e-11,1.39698363987861e-10,1,0,110.483184814453,0.0225259643048048,-5.09999895095825,1],"type":"Primitive","visible":false,"width":35,"worldPosition":[110.483184814453,0.0225259643048048,-5.09999895095825]},"random":{"c":1,"s0":0.134394,"s1":0.921757,"s2":0.045269},"sequence":0,"source":"vwf/model/threejs/box.js","type":"subDriver/threejs","name":"N36e4b9bb"},{"extends":"sphere2.vwf","properties":{"DisplayName":"sphere2","___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_angular":[0,0,0],"___physics_velocity_linear":[0,0,0],"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"blendMode":1,"color":{"a":1,"b":1,"g":1,"r":1},"depthtest":true,"depthwrite":true,"emit":{"b":0,"g":0,"r":0},"fog":true,"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"metal":false,"reflect":0,"shadeless":false,"shading":true,"shadow":true,"shininess":15,"side":0,"specularColor":{"a":1,"b":0.57735,"g":0.57735,"r":0.57735},"specularLevel":1,"type":"phong","vertexColors":false,"wireframe":false},"owner":"admin","transform":[1,0,0,0,0,1,0,0,0,0,1,0,1.5,1.25,0,1],"type":"Primitive"},"random":{"c":1,"s0":0.498784,"s1":0.977276,"s2":0.219963},"sequence":0,"source":"vwf/model/threejs/sphere.js","type":"subDriver/threejs","name":"N5f45926e"},{"extends":"ocean/ocean.vwf","properties":{"DisplayName":"OceanShader","gA":0.092,"transform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"uChop":0.733,"uNormalPower":0.184,"uOceanDepth":0.037,"uReflectPow":3,"waterHeight":1},"random":{"c":1,"s0":0.958527410868555,"s1":0.854632618371397,"s2":0.216585814487189},"sequence":0,"source":"ocean/ocean.js","type":"subDriver/threejs","name":"Nd286a999"},{"extends":"sphere2.vwf","properties":{"DisplayName":"sphere1","___physics_activation_state":1,"___physics_deactivation_time":0,"___physics_velocity_angular":[0,0,0],"___physics_velocity_linear":[0,0,0],"materialDef":{"alpha":1,"ambient":{"b":1,"g":1,"r":1},"blendMode":1,"color":{"a":1,"b":1,"g":1,"r":1},"depthtest":true,"depthwrite":true,"emit":{"b":0,"g":0,"r":0},"fog":true,"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0,"offsety":0,"rot":0,"scalex":1,"scaley":1,"src":"checker.jpg"}],"metal":false,"reflect":0,"shadeless":false,"shading":true,"shadow":true,"shininess":15,"side":0,"specularColor":{"a":1,"b":0.57735,"g":0.57735,"r":0.57735},"specularLevel":1,"type":"phong","vertexColors":false,"wireframe":false},"owner":"admin","transform":[0.999997019767761,0,0,0,0,0.999997019767761,0,0,0,0,0.999997019767761,0,1.74999701976776,7.24999809265137,1.99999701976776,1],"type":"Primitive"},"random":{"c":1,"s0":0.865661,"s1":0.122404,"s2":0.270616},"sequence":0,"source":"vwf/model/threejs/sphere.js","type":"subDriver/threejs","name":"Neeecddab"},{"DisplayName":null,"glyphURL":"../vwf/view/editorview/images/icons/scene.png","simTime":277661,"placemarks":{"Origin":[0,0,2]},"navmode":"none","sunColor":[1,0.945098,0.6],"sunDirection":[1.55,-0.2,1],"sunIntensity":1.3,"shadowDarkness":0.65,"ambientColor":[0.35,0.35,0.35],"additionalUrlAsset":"None","additionalUrlAssetsList":["None"],"fogColor":[0.980392,0.803921,0.588235],"fogNear":0,"fogFar":50,"fogType":"exp","fogDensity":0.003,"fogVFalloff":0.539,"fogVFalloffStart":22.6,"skyColorBlend":0.5,"skyFogBlend":0.16,"skyApexColor":[0.305882,0.603921,0.949019],"skyHorizonColor":[1,0.921568,0.749019],"___physics_gravity":[0,0,-9.8],"___physics_accuracy":10,"___physics_active":true,"vAtmosphereDensity":0.0005,"playMode":"play","octreeObjects":5,"octreeDepth":16,"octreeExtents":640,"owner":"Rob","type":"scene","___clientAPI":true,"materialDef":{"shininess":4,"alpha":1,"ambient":{"r":0.8,"g":0.8,"b":0.8},"color":{"r":1,"g":1,"b":1,"a":1},"emit":{"r":0,"g":0,"b":0},"reflect":0,"shadeless":false,"shadow":true,"specularColor":{"r":1,"g":0.65098,"b":0},"specularLevel":0.305,"layers":[{"alpha":1,"blendMode":0,"mapInput":0,"mapTo":1,"offsetx":0.11,"offsety":0.11,"rot":0,"scalex":"10","scaley":"10","src":"./contentlibraries/environments/assets/dirt.jpg"},{"offsetx":0,"offsety":0,"scalex":1,"scaley":1,"rot":0,"blendMode":0,"mapTo":"4","mapInput":0,"alpha":0.27,"src":"./contentlibraries/environments/assets/waternormal.jpg"}],"type":"phong","side":2,"wireframe":false,"metal":false,"combine":0,"depthtest":true,"depthwrite":true},"skyTexture":"cloudy_noon","publishSettings":{"singlePlayer":false,"camera":"","allowAnonymous":false,"createAvatar":false,"allowTools":false},"skyAtmosphereDensity":1}]